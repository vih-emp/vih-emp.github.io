<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Turkish March</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- abcjs CDN for sheet music and sound -->
  <script src="https://cdn.jsdelivr.net/npm/abcjs@6.2.2/dist/abcjs-basic-min.js"></script>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Segoe UI', Candara, 'Geneva', Verdana, sans-serif;
      background: linear-gradient(135deg, #90e0ef 0%, #4361ee 100%);
      position: relative;
      overflow: hidden;
    }
    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 3em;
      color: #fff;
      text-shadow: 2px 2px 12px #4361ee;
      margin: 0.5em 0 0.2em 0;
      text-align: center;
    }
    #controls {
      text-align: center;
      margin: 1em 0;
    }
    #notation {
      background: rgba(255,255,255,0.90);
      border-radius: 18px;
      padding: 2em 1em 1em 1em;
      margin: 0 auto;
      box-shadow: 0 8px 32px #4361ee55, 0 1.5px 8px #fff8;
      width: min(90vw, 640px);
    }
    #chaos-btn {
      background: linear-gradient(90deg, #ffd60a 0%, #ff6f3c 100%);
      color: #222;
      border: none;
      border-radius: 8px;
      padding: 0.8em 2em;
      font-size: 1.3em;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 3px 12px #ff6f3c55;
      margin-left: 1em;
      transition: background 0.2s, transform 0.2s;
    }
    #chaos-btn.active {
      background: linear-gradient(90deg, #f72585 0%, #b5179e 100%);
      color: #fff;
      transform: scale(1.09) rotate(-2deg);
      box-shadow: 0 6px 24px #f7258555;
    }
    #play-btn {
      background: linear-gradient(90deg, #00b4d8 0%, #48cae4 100%);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 0.8em 2em;
      font-size: 1.3em;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 3px 12px #48cae455;
      margin-right: 1em;
      transition: background 0.2s, transform 0.2s;
    }
    #play-btn:active {
      background: linear-gradient(90deg, #4361ee 0%, #48cae4 100%);
      transform: scale(1.03) rotate(1deg);
    }
    /* Flying notes styling */
    .note {
      font-size: 2.2em;
      color: #ffbe0b;
      position: fixed;
      pointer-events: none;
      z-index: 1000;
      opacity: 0.76;
      animation: fly-note 5s linear infinite;
      filter: drop-shadow(0 2px 8px #ffbe0bcc);
      user-select: none;
      will-change: transform, opacity;
    }
    .note2 { color: #7209b7; }
    .note3 { color: #3a86ff; }
    .note4 { color: #ff006e; }
    .note5 { color: #43aa8b; }
    .note6 { color: #fb5607; }
    @keyframes fly-note {
      0% {
        transform: translateY(100vh) scale(0.7) rotate(-30deg);
        opacity: 0.82;
      }
      40% {
        opacity: 1;
      }
      100% {
        transform: translateY(-15vh) scale(1.15) rotate(30deg);
        opacity: 0.1;
      }
    }
    /* Glow effect for fancy! */
    .glow {
      text-shadow:
        0 0 8px #fff, 
        0 0 18px #ffd60a, 
        0 0 36px #ff6f3c;
    }
    /* Responsive tweaks */
    @media (max-width: 600px) {
      h1 { font-size: 2em; }
      #notation { padding: 1em 0.5em 0.5em 0.5em; }
    }
  </style>
</head>
<body>
  <h1 class="glow">üéπ Turkish March <span style="font-size:0.7em;">(Mozart)</span></h1>
  <div id="controls">
    <button id="play-btn">‚ñ∂Ô∏è Play</button>
    <button id="chaos-btn">CHAOS Mode</button>
  </div>
  <div id="notation"></div>

  <script>
    // The Turkish March in ABC notation
    const abc = `
X:1
T:Turkish March (Rondo Alla Turca)
C:W.A. Mozart
M:2/4
L:1/8
Q:1/4=120
K:A
|: E2 E2 E2 C2 | E2 G2 G,2 z2 |
   C2 G,2 E,2 A,2 | B,2 ^A,2 B,2 z2 |
   E2 ^G,2 B,2 C2 | E2 A,2 z2 z2 :|
`;

    // Render ABC notation
    ABCJS.renderAbc("notation", abc, { responsive: "resize" });

    // Sound playback
    let synthControl = null;
    document.getElementById('play-btn').onclick = async function () {
      if (synthControl) {
        synthControl.pause();
      }
      synthControl = new ABCJS.synth.SynthController();
      synthControl.load("#notation", {}, { displayRestart: false, displayPlay: false, displayProgress: false });
      let synth = new ABCJS.synth.CreateSynth();
      await synth.init({ visualObj: ABCJS.renderAbc("notation", abc)[0] });
      synthControl.setTune(ABCJS.renderAbc("notation", abc)[0], false).then(() => {
        synthControl.play();
      });
    };

    // Flying notes
    const notes = [
      'üéµ','üé∂','ùÑû','‚ô¨','‚ô©','‚ô´','ùÑ´','ùÑ°','‚ô©','‚ô≠','ùÑ™','‚ôØ','ùÑ¢',
    ];
    const noteClasses = ['note','note2','note3','note4','note5','note6'];
    let chaos = false;
    let chaosInterval = null;
    let normalNotesActive = true;
    let chaosNotes = [];

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function spawnNote(isChaos=false) {
      const noteEl = document.createElement('div');
      noteEl.className = noteClasses[randomInt(0, noteClasses.length-1)] + ' note';
      noteEl.innerText = notes[randomInt(0, notes.length-1)];
      noteEl.style.left = randomInt(2, 96) + 'vw';
      noteEl.style.fontSize = (isChaos ? randomInt(1, 3) : randomInt(2, 4)) + 'em';
      noteEl.style.animationDuration = (isChaos ? randomInt(2, 5) : randomInt(4, 8)) + 's';
      noteEl.style.top = '100vh';
      document.body.appendChild(noteEl);
      setTimeout(() => noteEl.remove(), isChaos ? 5000 : 9000);
      if(isChaos) chaosNotes.push(noteEl);
    }

    // Normal mode: gentle flying notes
    function gentleNotesLoop() {
      if (!chaos) {
        spawnNote();
        setTimeout(gentleNotesLoop, randomInt(700, 1700));
      }
    }
    gentleNotesLoop();

    // CHAOS mode
    document.getElementById('chaos-btn').onclick = function() {
      chaos = !chaos;
      this.classList.toggle('active', chaos);
      this.textContent = chaos ? 'CHAOS Mode: ON' : 'CHAOS Mode';
      if (chaos) {
        // Spawn 100+ notes rapidly and continuously
        for (let i=0; i<100; ++i) {
          setTimeout(() => spawnNote(true), randomInt(0, 1200));
        }
        chaosInterval = setInterval(() => {
          for (let i=0; i<12; i++) spawnNote(true);
        }, 350);
      } else {
        if (chaosInterval) clearInterval(chaosInterval);
        chaosNotes.forEach(el => el.remove());
        chaosNotes = [];
        gentleNotesLoop();
      }
    };
  </script>
</body>
</html>